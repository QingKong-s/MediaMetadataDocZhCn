# Ogg Vorbis I 格式规范：注释字段和头规范

## 备注

**本节为译者添加。**

**翻译自：**

+ <https://xiph.org/vorbis/doc/v-comment.html>

**译者非音乐或数字多媒体行业专业人士，组织此文档仅用于软件开发，部分机翻错误已纠正，若有专业术语翻译错误或不合理的情况，请提交拉取请求或issue。**

**译者不对本文作任何保证，包括但不限于行文描述准确性的保证，读者应自行评判准确性并对可能因参考本文造成的错误承担一切责任。**

# 概述

Vorbis文本注释头是Vorbis比特流开始的第2个（3个）标头数据包。它用于简短的文本注释，而不是任意的元数据；任意的元数据属于单独的逻辑比特流（通常是XML流类型），可提供更强的结构和机器解析能力。

注释字段的用途很像在CDR底部快速记下一笔。它应该是用来记住光盘和向他人解释光盘的一点信息；一个简短、切题的文本注释，不需要只有几个字，但也不会超过一小段。换句话说，无论要点是什么，例如

```
"Honest Bob and the Factory-to-Dealer-Incentives, _I'm Still Around_, opening for Moxy Früvous, 1997".
```

# 注释编码

## 结构

从逻辑上讲，注释头是一个八位清洁(8bit clean)向量列表；向量的数量限制为$ 2^{32}-1 $，每个向量的长度限制为$ 2^{32}-1 $字节。向量长度已编码；向量内容本身不以空值结束。除了向量列表外，还有一个供应商名称向量（也是8位清洁的，长度以32位编码）。例如，1.0版libvorbis将供应商字符串设置为`"Xiph.Org libVorbis I 20020717"`。

注释头的解码如下：

1. `vendor_length` = 读取一个32位的无符号整数
2. `vendor_string` = 读取一个长为`vendor_length`字节的UTF-8字符串
3. `user_comment_list_length` = 读取一个32位无符号整数
4. 遍历`user_comment_list_length`次
    1. `length` = 读取一个32位无符号整数
    2. 此次迭代的注释 = 读取一个长为`length`字节的UTF-8字符串
5. `framing_bit` = 以布尔形式读取单个位
6. if (`framing_bit`未设置 或 数据流结束) then 出错
7. 完成

## 内容向量格式

注释向量的结构类似于UNIX环境变量。也就是说，注释字段由一个**不区分大小写**的字段名和一个相应的值组成，其结构如下

```
comment[0]="ARTIST=me"; 
comment[1]="TITLE=the sound of Vorbis";
```

字段名可由ASCII `0x20`至`0x7D`的字符组成，`0x3D（'='）`除外。ASCII `0x41`至`0x5A`（含A-Z）等同于ASCII `0x61`至`0x7A`（含 a-z）。

字段名后紧跟ASCII `0x3D（'='）`；该等号用于终止字段名。

0x3D之后是字段内容的八位清洁UTF-8编码值，直至字段末尾。

## 字段名称

以下是建议的标准字段名的最小列表，并附有预期用途说明。没有任何一个或一组字段名称是强制性的；注释头可以包含本列表中的一个、全部或任何名称。

|键名|含义|
|-|-|
|TITLE|音轨或作品名称|
|VERSION|用于区分单个合集中同一曲目标题的多个版本。(例如混音信息）|
|ALBUM|此音轨所属的音集名称|
|TRACKNUMBER|如果该曲目是某个大型合集或专辑的一部分，则为该曲目的曲目编号|
|ARTIST|一般认为对作品负责的艺术家。在流行音乐中，通常指表演乐队或歌手。古典音乐则是作曲家。对于有声读物，则指原文作者|
|PERFORMER|表演作品的艺术家。在古典音乐中，指指挥家、管弦乐队、独奏家。在有声读物中，则是朗读的演员。在流行音乐中，这通常与艺术家相同，故省略|
|COPYRIGHT|版权归属，如"2001 Nobody's Band"或"1999 Jack Moffitt"。|
|LICENSE|许可证信息，例如"保留所有权利"、"允许任何使用"、共享创意许可证等许可证的URL（例如"creativecommons.org/licenses/by/4.0/"）或类似信息|
|ORGANIZATION|制作音轨的机构名称（即唱片公司）|
|DESCRIPTION|内容的简短文字说明|
|GENRE|流派的简短文字说明|
|DATE|曲目录制日期|
|LOCATION|曲目录制地点|
|CONTACT|曲目创作者或发行者的联系信息。可以是URL、电子邮件地址或制作公司的实际地址。|
|ISRC|音轨的ISRC编号|

## 注意

字段名称不应"国际化"；这只是为了简化而做出的让步，并不是要将世界上大多数不讲英语的人排除在外。但是，字段内容使用UTF-8字符编码，以便于任何语言的表述。

我们有整个字段的长度和对字段名的限制，这样字段名就有了已知的边界。因此，我们也有字段内容的长度。

个别"供应商"可以在合理的范围内使用非标准字段名称。注释字段的正确使用应通过上下文明确。我们不鼓励滥用。

"非标准"字段名没有特定的供应商前缀。供应商应努力避免任意污染通用名称空间。我们通常会在这里收集更有用的标记，以帮助实现标准化。

在注释标头中，字段名不要求唯一（出现一次）。例如，假设一首曲目是由三位知名艺术家录制的，可以使用并鼓励使用以下名称：

```
ARTIST=Dizzy Gillespie 
ARTIST=Sonny Rollins 
ARTIST=Sonny Stitt 
```

## 编码

注释标头包含第2个比特流标头数据包的全部内容。与第1比特流标头数据包不同，它通常不是第2页上的唯一数据包，也可能不限于第2比特流页面内。注释标头数据包的长度（实际上）不受限制。注释标头数据包不是可选的，即使它实际上是空的，也必须出现在比特流中。

注释标头的编码如下（按照Ogg的标准比特流映射，将字的最小有效位先编码到当前比特流八进制的最小有效位）：

|名称|备注|
|-|-|
|供应商字符串长度|32位无符号整数，指定八位字节长度|
|供应商字符串|从字符串开头到字符串结尾的八位字节长度为`[供应商字符串长度]`，不以空值结束|
|注释字段数|32位无符号整数，指定字段数|
|注释字段0的长度|32位无符号整数，指定八位字节长度（如果`[注释字段数目]` > 0）|
|注释字段0|从字符串开头到字符串结尾的八位字节长度为`[注释字段0长度]`，不以空值结束|
|注释字段1的长度|如果`[注释字段数量]` > 1 ......|
|...|...|

实际上，用代码来描述更容易一些；上述实现可以在vorbis/lib/info.c:_vorbis_pack_comment(),_vorbis_unpack_comment()中找到。

# 版权

**These pages © 1994 - 2005 Xiph.Org. All rights reserved.**
